name: NetBSD

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest

    strategy:
      fail-fast: false
      matrix:
        netbsd-version: ['10.0', '9.4', '9.3', '9.2']

    steps:
      - uses: cross-platform-actions/action@master
        with:
          operating_system: netbsd
          version: ${{ matrix.netbsd-version }}
          shell: bash
          run: |
            set -ex

            sudo pkgin -y update
            sudo pkgin -y install curl bsdtar

            curl -LO https://raw.githubusercontent.com/leleliu008/ppkg/master/ppkg
            chmod a+x ppkg

            #sed -i 's|pkgin -y install bash|pkgin -y install bash cmake|' ppkg

            ./ppkg setup --syspm
            ./ppkg search lib
